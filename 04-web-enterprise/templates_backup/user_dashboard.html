<!DOCTYPE html>
<html>
<head>
    <title>User Dashboard - TFA Shuttles</title>
    <style>
        body { background-color: #36454f; color: white; font-family: Arial; }
        .container { max-width: 800px; margin: 20px auto; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; }
        .btn { padding: 10px 15px; margin: 5px; background: #007bff; color: white; text-decoration: none; border-radius: 4px; }
        .booking { background: #2c3e50; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .status { padding: 5px 10px; border-radius: 3px; font-weight: bold; }
        .unassigned { background: #f39c12; }
        .in-progress { background: #3498db; }
        .completed { background: #27ae60; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Welcome, {{ current_user.get_id() }}</h1>
            <a href="{{ url_for('logout') }}" class="btn">Logout</a>
        </div>

        <div style="margin: 20px 0;">
            <a href="{{ url_for('booking') }}" class="btn">Book New Trip</a>
        </div>

        <h2>My Bookings</h2>
        {% if bookings %}
            {% for booking in bookings %}
            <div class="booking">
                <p><strong>Pickup:</strong> {{ booking.pickup }} â†’ <strong>Dropoff:</strong> {{ booking.dropoff }}</p>
                <p><strong>Time:</strong> {{ booking.date_time }}</p>
                <p><strong>Status:</strong> 
                    <span class="status {{ booking.status }}">{{ booking.status.upper() }}</span>
                </p>
                {% if booking.status == 'unassigned' %}
                <form method="POST" action="{{ url_for('confirm_entry') }}">
                    <input type="hidden" name="booking_index" value="{{ booking.id }}">
                    <button type="submit" class="btn">Confirm Entry</button>
                </form>
                {% endif %}
            </div>
            {% endfor %}
        {% else %}
            <p>No bookings yet. <a href="{{ url_for('booking') }}">Book your first trip!</a></p>
        {% endif %}

        {% if user_data %}
        <div style="margin-top: 30px; padding: 15px; background: #2c3e50; border-radius: 5px;">
            <h3>Account Information</h3>
            <p><strong>Travel Allowance:</strong> R {{ "%.2f"|format(user_data.travel_allowance) }}</p>
            {% if penalties %}
            <p><strong>Penalties:</strong> {{ penalties|length }}</p>
            {% endif %}
        </div>
        {% endif %}
    </div>
</body>
</html>
